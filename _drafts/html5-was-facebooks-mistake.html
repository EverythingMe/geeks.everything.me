---
layout: post
title: HTML5 was Facebook's mistake?
date: 
type: post
published: false
status: draft
categories: []
tags: []
meta:
  _edit_last: '18'
  dsq_thread_id: ''
author:
  login: ranbena
  email: ran@doat.com
  display_name: Ran Ben Aharon
  first_name: Ran
  last_name: Ben Aharon
---
<p>So, Zuckerberg <a href="http://techcrunch.com/2012/09/11/mark-zuckerberg-our-biggest-mistake-with-mobile-was-betting-too-much-on-html5/" target="_blank">announced</a> "..the biggest mistake that we made, as a company, is betting too much on HTML5 as opposed to native..". They've completely overhauled their mobile app for iOS last month, adding new features and claiming better responsiveness.</p>
<p>At first, I was <a href="http://techcrunch.com/2012/09/11/mark-zuckerberg-our-biggest-mistake-with-mobile-was-betting-too-much-on-html5/?fb_comment_id=fbc_341699529258078_1853774_342065982554766#f2d0dc8427fe5ac" target="_blank">outraged</a>. Facebook was born of the web. The browser is their home and HTML their mother tongue. Facebook was one of the first major companies to rely heavily on mobile web. So what happened?<br />
<!--more--><br />
PPK <a href="http://www.quirksmode.org/blog/archives/2012/09/facebooks_html5.html" target="_blank">said</a> it might be that the Android browser gave them a hard time or perhaps investor politics. Yehuda Katz told of <a href="https://twitter.com/wycats/status/245971316031762432" target="_blank">incompetent execution</a>.</p>
<p>They have not engineered the best HTML5 approach. One example, is that instead of receiving server data as JSON, the response was rendered HTML - making pulling down data slower, local caching troublesome and version updates more complex.</p>
<p>Following requests to provide details on the matter, Tobie Langel posted feedback on <a href="http://lists.w3.org/Archives/Public/public-coremob/2012Sep/0021.html">what's slowing down mobile Facebook</a> and raised some interesting points.</p>
<p><strong>Stability</strong><br />
Browser crashes occur and there's no tool or developer API to understand or anticipate them.</p>
<p>Valid claim. GPU buffer exhaustion, resource limit reach and even certain javascript combinations can cause browser crashes. LinkedIn <a href="http://engineering.linkedin.com/linkedin-ipad-5-techniques-smooth-infinite-scrolling-html5">coped</a> with it in their hybrid iPad app, but Facebook's interface doesn't implement a "snap to element" scroll so it's quite different.</p>
<p><strong>FPS</strong><br />
Major performance issues with infinite scrolling.</p>
<p>Arguable. Facebook went for a JS scrolling implementation which is decreasingly performant as content is added to the scrolled element. Also, background i/o and computation will cause scroll stuttering. So, why not go for native browser scrolling?</p>
<p>Pull to refresh feature - can't overscroll in the Android browsers, nor get sufficient scroll events from Mobile Safari. But, if used as a hybrid, and a communications layer is established, the native wrapper can implement this feature instead of the browser, therefore enabling the use of native browser scrolling. True story.</p>
<p>Fresh content injection while scrolling - unfortunately, scroll stuttering is inevitable.</p>
<p><strong>Caching</strong><br />
"Appcache is soooo busted"</p>
<p>Seriously? RTFM! It's incredibly useful and valuable once understood and correctly implemented. Takes a while to get it right.</p>
<p>Tobie also notes the need for "better caching". Agreed. LocalStorage is commonly implemented but blocky and limited to 5MB. IndexedDB is a async and enables up to 100MB of storage but isn't widely available.</p>
<p><strong>Conclusion</strong><br />
Native apps lack the most basic benefit of HTML5 - enabling version updates and fixes upon re-opening the app. Facebook <a href="https://www.facebook.com/notes/facebook-engineering/under-the-hood-rebuilding-facebook-for-ios/10151036091753920">addresses</a> that and says:<br />
"..For areas within the app where we anticipate making changes more often, we will continue to utilize HTML5 code, as we can push updates server side without requiring people to download a new version of the app..".<br />
Moreover, Facebook claims that it is currently being accessed from more than 7,000 different mobile devices - probably not gonna make as much native apps.</p>
<p>Phew... Load off my chest :)</p>
